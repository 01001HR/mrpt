<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0039)http://www.mrpt.org/book/export/html/39 -->
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">

    
    <TITLE>Compiling MRPT</TITLE>
    <!--<BASE href="http://www.mrpt.org">--><BASE href=".">
    <LINK type="text/css" rel="stylesheet" href="./install_files/print.css">
      </HEAD><BODY>
              <DIV class="section-1">
                <DIV class="section-2">
                <DIV class="section-3">
          
    <DIV id="node-39" class="section-4">
  <H1 class="book-heading">Compiling MRPT</H1>
  
<SCRIPT type="text/javascript">toc_collapse=0;</SCRIPT><DIV class="toc" id="toc">
<DIV class="toc-title">Table of contents<SPAN class="toc-toggle-message">&nbsp;</SPAN></DIV>
<DIV class="toc-list">
<UL>
	<LI class="toc-level-1"><A href="http://www.mrpt.org/#Prerequisites">1. Prerequisites</A>
<UL>
	<LI class="toc-level-2"><A href="http://www.mrpt.org/#On_Windows">1.1. On Windows</A></LI>
	<LI class="toc-level-2"><A href="http://www.mrpt.org/#On_GNULinux">1.2. On GNU/Linux</A></LI>
	<LI class="toc-level-2"><A href="http://www.mrpt.org/#On_Mac">1.3. On Mac</A></LI>
</UL>
</LI>
	<LI class="toc-level-1"><A href="http://www.mrpt.org/#CMake_build_options">2. CMake build options</A>
<UL>
	<LI class="toc-level-2"><A href="http://www.mrpt.org/#Using_cmake-gui">2.1. Using cmake-gui</A></LI>
	<LI class="toc-level-2"><A href="http://www.mrpt.org/#Using_cmake_from_the_console">2.2. Using cmake from the console</A></LI>
	<LI class="toc-level-2"><A href="http://www.mrpt.org/#Interesting_build_options">2.3. Interesting build options</A></LI>
</UL>
</LI>
	<LI class="toc-level-1"><A href="http://www.mrpt.org/#Generate_MakefilesIDE_Projects">3. Generate Makefiles/IDE Projects</A></LI>
	<LI class="toc-level-1"><A href="http://www.mrpt.org/#Compile">4. Compile</A></LI>
	<LI class="toc-level-1"><A href="http://www.mrpt.org/#Special_instructions_for_MinGW">5. Special instructions for MinGW</A></LI>
</UL>
</DIV>
</DIV>

This page describes how to <B>build MRPT from sources</B>. If you want instead to install the binaries and getting quickly into developing your MRPT-based applications, go to the <A href="http://www.mrpt.org/download">download page</A> and grab the <B>binaries for your system</B>.

Please, report <B>errors or doubts</B> on MRPT compilation to the <A href="http://www.mrpt.org/forum-users">mrpt-users forum</A>.


<BR><BR><HR>
<H2 id="Prerequisites">1. Prerequisites</H2><BR>

<BR>
<H3 id="On_Windows">1.1. On Windows</H3>
<DIV style="float: right;"><IMG src="./install_files/icon_win.png"></DIV>
<BR>

<H4 id="CMake"> 1.1.1 CMake</H4>

To install the CMake build system, follow the instructions at http://www.cmake.org/cmake/resources/software.html

<BR>
<H4 id="wxWidgets_"> 1.1.2 wxWidgets </H4>

In addition to the following notes, read the project's wiki: http://wiki.wxwidgets.org/MSVC

Also, if you want to build for 64bit (x64), be aware of the limited support of wxWidgets for this platform in Windows yet (read <A href="http://wiki.wxwidgets.org/Supporting_x64_and_Win32_within_one_solution">this</A>).

The source package for the wxWidgets library (named "wxALL" or "wxMSW", currently version 2.8.11) must be downloaded from <A href="http://www.wxwidgets.org/downloads/">here</A> and decompressed in a directory where CMake can find it (e.g. C:\wxWidgets).

In Windows <B>you'll have to manually modify the flag to compile the OpenGL support</B> of wxWidgets. This is achieved by setting <B>wxUSE_GLCANVAS to 1</B> (the default is 0). This is the part of the file <CODE>wxwidgets\include\wx\msw\setup.h </CODE> that has to be modified:

<PRE class="brush: cpp">// Setting wxUSE_GLCANVAS to 1 enables OpenGL support. You need to have OpenGL
// headers and libraries to be able to compile the library with wxUSE_GLCANVAS
// set to 1. Note that for some compilers (notably Microsoft Visual C++) you
// will need to manually add opengl32.lib and glu32.lib to the list of
// libraries linked with your program if you use OpenGL.
//
// Default is 0.
//
// Recommended setting: 1 if you intend to use OpenGL, 0 otherwise
#define wxUSE_GLCANVAS       1
</PRE>

Now, depending on your version of wxWidgets, open the Visual Studio project (which may be <B>wxwidgets\build\msw\wx_dll.dsw</B> or  <B>wxwidgets\build\msw\wx_vcX.sln</B>).  I recommend to build, with "Build all", only these configurations:

<UL>
<LI>DLL Unicode Release  (or just "DLL Release" in wxWidgets &gt;=2.9) </LI>
<LI>DLL Unicode Debug (or just "DLL Debug" in wxWidgets &gt;=2.9) </LI>
</UL>


<BR>
<H4 id="OpenCV">1.1.3 OpenCV</H4>

It is recommended to compile MRPT against <B>OpenCV 2.0.0</B> (or newer) in order to enjoy the new features such as SURF descriptors. See the instructions in: http://opencv.willowgarage.com/wiki/InstallGuide

One interesting option is to compile a SVN snapshot of OpenCV:
Checkout a fresh copy of the development branch by executing: (NOV-2009: OpenCV hosting changed, this is the new SVN uri:)

<PRE class="bordered">svn co https://code.ros.org/svn/opencv/trunk/opencv/ opencv
</PRE>

or use the graphical program TortoiseSVN.

Then follow the <A href="https://code.ros.org/svn/opencv/trunk/opencv/INSTALL">compiling instructions</A>. 

Once compiled with CMake, running "Configure" in MRPT's CMake project will automatically detect the OpenCV build directory (where you have generated the projects with CMake) and will use it. If it's not detected, set <B>OpenCV_DIR</B> to the build directory of OpenCV.

<BR><BR>
<H4 id="FFmpeg_for_Win32">1.1.4 FFmpeg for Win32</H4>
The FFmpeg libraries are <B>optional</B>, and they are only needed if you want to use <A href="http://reference.mrpt.org/svn/classmrpt_1_1hwdrivers_1_1_c_f_f_m_p_e_g___input_stream.html">CFFMPEG_InputStream</A>, mainly for supporting IP cameras.

Directly download and decompress anywhere in your disk :
<UL>
<LI> http://ffmpeg.arrozcru.org/builds/shared/ffmpeg-r16537-gpl-lshared-win32.tar.bz2 </LI>
<LI> or this local copy:  http://babel.isa.uma.es/mrpt/downloads/ffmpeg-r16537-gpl-lshared-win32.tar.bz2 </LI>
<LI> or see the "Unofficial win32 builds" web for more recent releases: http://ffmpeg.arrozcru.org/autobuilds/
</LI></UL>

Then when running CMake (cmake-gui), enable <CODE>MRPT_HAS_FFMPEG_WIN32</CODE>, press "Configure" and then set <CODE>FFMPEG_WIN32_ROOT_DIR</CODE> to the directory where FFmpeg binaries have been uncompressed (e.g. "c:\ffmpeg-r16537-gpl-lshared-win32").

The FFmpeg DLLs will be required at runtime by programs compiled with MRPT under Windows, so make sure the directory <FFMPEG>/bin is in the <B>system PATH</B>.


<BR><BR>
<H3 id="On_GNULinux">1.2. On GNU/Linux</H3>
<DIV style="float: right;"><IMG src="./install_files/icon_linux.png"></DIV>
<BR>


<H4 id="Dependencies">1.2.1. Dependencies</H4>
<BR>

These are the recommended libraries (the <B>development</B> packages!) that should exist in your system (see below for short instructions for Ubuntu/Debian/Fedora):
<UL>
<LI>OpenCV </LI>
<LI>wxWidgets </LI>
<LI>ffmpeg libraries (libavcodec, libswscale, etc.) </LI>
<LI>Freeglut or glut </LI>
<LI>zlib </LI>
<LI>libftdi (optional) </LI>
<LI>libdc1394-22 </LI>
</UL>


<H4 id="About_OpenCV">1.2.2. About OpenCV</H4>
<BR>
You can compile MRPT against OpenCV 1.0.0, 1.1.0 or &gt;=2.0.0, but it won't compile with OpenCV 1.1.0-pre1. 

Install opencv libraries from your repositories or build it manually from SVN HEAD (I prefer this way...), by checking out a fresh copy of the development branch by executing: 

<PRE class="bordered">svn co https://code.ros.org/svn/opencv/trunk/opencv/ opencv
</PRE>

And follow the compiling instructions.
Under Linux, you'll <B>NOT</B> need to do a "make install" after building OpenCV, since setting the OpenCV_DIR variable in CMake while compiling MRPT is enough.


<BR><BR>
<H4 id="Ubuntu_Debian"> 1.2.2 Ubuntu, Debian</H4>
<BR>
Invoke:
<PRE class="bordered"> $ sudo apt-get install build-essential cmake libwxgtk2.8-dev \
   libwxbase2.8-dbg libwxgtk2.8-dbg libftdi-dev libglut3-dev \
   libhighgui-dev
</PRE>

(Note: You'll need to add libcvaux-dev, only if that package exists in your distribution and you haven't compile OpenCV manually)

If you have a modern Debian/Ubuntu, install this in addition to the packages above (they are not mandatory, but <B>recommended</B>):
<PRE class="bordered"> $ sudo apt-get install libdc1394-22-dev libavformat-dev libswscale-dev
</PRE>

Note: If the version 2.8 (or newer) of wxWidgets is not available in your distribution, it must be installed manually.

<BR><BR>
<H4 id="Fedora"> 1.2.3 Fedora</H4>
<BR>

Execute:
<PRE class="bordered"> $ su -c 'yum install gcc gcc-c++ make cmake wxGTK-devel opencv-devel freeglut-devel'
</PRE>

<BR>
<H4 id="OpenSUSE"> 1.2.4 OpenSUSE</H4>
<BR>

For OpenSUSE 10.X, invoke:
<PRE class="bordered"> $ sudo zypper install make gcc gcc-c++ cmake cmake-gui pkg-config \
      zlib-devel wxGTK-devel wxGTK-gl libusb-devel freeglut-devel
</PRE>

For OpenSUSE 11.X, invoke:
<PRE class="bordered"> $ sudo zypper install make gcc gcc-c++ cmake cmake-gui pkg-config \
      zlib-devel wxGTK-devel wxGTK-gl libusb-devel freeglut-devel 
</PRE>



<BR><BR><BR>
<H3 id="On_Mac">1.3. On Mac</H3>
<DIV style="float: right;"><IMG src="./install_files/icon_macos.jpg"></DIV>
<BR>

Building under MacOS is not yet working 100%. Instructions will be given when we solve all the problems.


<BR><BR>

<BR><BR><HR>
<H2 id="CMake_build_options">2. CMake build options</H2><BR>


<BR><H3 id="Using_cmake-gui">2.1. Using cmake-gui</H3>
<BR>

Open cmake-gui (Available for Windows/Linux) and set the "source dir" to the root directory of the MRPT source package you have downloaded. 
Set the "binary directory" to a <B>new, empty</B> directory where to generate the project files. 

Press "configure", check for errors, tune the options as required (read below for a description of some options) and finally click "Generate".


<BR><BR>

<BR><H3 id="Using_cmake_from_the_console">2.2. Using cmake from the console</H3>

This choice is available for Windows/Linux/MacOS.

Go to a  <B>new, empty</B> directory where to generate the project/Makefiles files and run:

<PRE class="bordered">$ cmake /home/.../MRPT
</PRE>

Replace "/home/.../MRPT" with your actual path to the MRPT source package you have just downloaded. 

This will use all the default options. To tune them, invoke (available for Linux/MacOS):

<PRE class="bordered">$ ccmake .
</PRE>

<DIV align="center">
<A href="http://www.mrpt.org/sites/default/files/images/screenshot_cmake_console_linux.jpg">
<IMG width="250" src="./install_files/screenshot_cmake_console_linux.preview.jpg">
</A>
<SMALL>(Click the image to see it at full size)</SMALL>
</DIV>


<BR><H3 id="Interesting_build_options">2.3. Interesting build options</H3>

<B>For all platforms/compilers:</B>
<UL>

<LI><CODE> BUILD_SHARED_LIBS </CODE> : Build static libraries if set to OFF, or dynamic libraries (.so/.dll) otherwise. Default is ON, and it's <B>strongly recommended to always use shared libs</B> unless you have special need for static ones.</LI>

<LI><CODE> BUILD_EXAMPLES </CODE> : Whether you want to compile all the examples in the "/samples" directory. Default is OFF.</LI>

<LI><CODE>MRPT_ENABLE_EMBEDDED_ENABLED_PROFILER </CODE> : If enabled, all code blocks within macros "MRPT_BEGIN/MRPT_END" will be profiled and the statistics dumped to the console at the end of execution of any program. Default is OFF.</LI>

<LI><CODE>MRPT_ALWAYS_CHECKS_DEBUG </CODE> : If set to ON, additional security checks will be performed at run-time in many classes. Default is OFF. </LI>

<LI><CODE>MRPT_ALWAYS_CHECKS_DEBUG_MATRICES </CODE> : If set to ON, additional security checks will be performed at run-time in several Matrix operations. Default is ON.</LI>

<LI><CODE>MRPT_OCCUPANCY_GRID_CELLSIZE </CODE> : Can be either 8 or 16 (bits). The size of each cell in the class mrpt::slam::COccupancyGridMap2D. Default is 8 bits. More on this <A href="http://www.mrpt.org/Occupancy_Grids">here</A>.</LI>

<LI><CODE>USER_EXTRA_CPP_FLAGS </CODE> : You can add here whatever additional flags to be passed to the compiler.</LI>

<LI><CODE>MRPT_HAS_ASIAN_FONTS </CODE> : Enables Asian fonts in CMRPTCanvas (see wiki page), but increases library size by 1.5Mb. Default is OFF.</LI>

<LI><CODE>BUILD_xSENS </CODE> : Whether to use the CMT library for interfacing xSens inertial sensors. Default is ON.</LI>
</UL>



<BR>

<B>For Windows only:</B>
<UL>
<LI><CODE>MRPT_HAS_FFMPEG_WIN32</CODE> : Enable this and (after running "Configure") then set FFMPEG_WIN32_ROOT_DIR to the directory where FFmpeg binaries have been uncompressed (e.g. "c:\ffmpeg-r16537-gpl-lshared-win32").</LI>
<LI><CODE>MRPT_HAS_BUMBLEBEE </CODE> : To enable integration of the Bumblebee stereo camera SDK. You'll need the vendor provided "Triclops" and "Digiclops" libraries. After setting this option to "ON", the new configuration fields "BUMBLEBEE_DIGICLOPS_ROOT_DIR" and "BUMBLEBEE_TRICLOPS_ROOT_DIR" will appear where the correct corresponding paths must be entered.</LI>
</UL>

<BR>


<B>For GNU GCC compiler only:</B>
<UL>
<LI><CODE>MRPT_ENABLE_LIBSTD_PARALLEL_MODE</CODE> : Enables the GNU libstdc++ parallel mode (See http://gcc.gnu.org/onlinedocs/libstdc++/manual/parallel_mode.html). Default is OFF.</LI>

<LI><CODE>MRPT_ENABLE_PROFILING</CODE> : Enables generation of information required for profiling. Default is OFF.</LI>

<LI><CODE>MRPT_OPTIMIZE_NATIVE</CODE> : Enables optimization for the current architecture (-mtune=native). Default is OFF for old GCC versions, ON for 4.2+. If you have an old version of GCC (&lt;4.2), this option cannot be set since it's not recognized by the compiler. Instead, set USER_EXTRA_CPP_FLAGS to the optimization flags for your platform, for example: -march=pentium4.</LI>

</UL>


<BR><BR><HR>
<H2 id="Generate_MakefilesIDE_Projects">3. Generate Makefiles/IDE Projects</H2><BR>

Just select your preferred Makefile/IDE system with CMake. Supported targets are 32/64 bit Visual Studio projects, Unix Makefiles, Codeblocks projects with MinGW, MinGW Makefiles, etc...


<BR><BR><HR>
<H2 id="Compile">4. Compile</H2><BR>


Just build as usual: from Visual Studio click on "Build all" for the targets you want to build (Debug or Release), for Unix Makefiles invoke: 

<PRE class="bordered">$ make -j2
</PRE>

After building everything, it's a good idea to run the tests by building the "test" target under Visual Studio or by "make test" in Unix/MacOS.

<BR>

<BR>
<H2 id="Special_instructions_for_MinGW">5. Special instructions for MinGW</H2>

<UL>

<LI>Install MinGW: Recommended: http://www.tdragon.net/recentgcc/ </LI>

<LI>Before compiling MRPT with MinGW, it's strongly recommended to compile wxWidgets and OpenCV with MinGW:</LI>
<LI>Build wxWidgets. Open a command prompt and go to the directory build/msw. Then execute the following commands to rebuild the Release and Debug configurations (as shared libs), so CMake can correctly detect wxWidgets:
<PRE class="bordered">mingw32-make -f makefile.gcc SHARED=1 USE_OPENGL=1 BUILD=release 
mingw32-make -f makefile.gcc SHARED=1 USE_OPENGL=1 BUILD=debug 
</PRE>
</LI>

<LI>Build OpenCV. Use its CMake build system, select the MinGW compiler and follow the generic OpenCV compilation instructions.</LI>

<LI>Open cmake-gui and select the source directory and an empty target (binary) directory.</LI>

<LI>Press configure and in the compilers dialog pick MinGW Makefiles. If you obtain an error like:
<PRE>CMake Error: CMake was unable to find a build program corresponding to "MinGW Makefiles".  
CMAKE_MAKE_PROGRAM is not set.  You probably need to select a different build tool.
</PRE>
it means MinGW is not correctly installed in the system. Review the installation process described above.</LI>

<LI>If everything goes fine, you'll see the new CMake variables remarked in red. Go through the normal configuration process for MRPT, and when you are satisfied, press Generate.</LI>

<LI>Open a console and in the newly created binary directory, invoke:
<PRE>mingw32-make
</PRE>
either by writing the full path (e.g. c:\MinGW\bin\mingw32-make) or by adding the "bin" directory of your MinGW installation to the system PATH. This should start the normal build process.</LI>

</UL></FFMPEG>  </DIV>
    </DIV></DIV></DIV>
  

</BODY></HTML>